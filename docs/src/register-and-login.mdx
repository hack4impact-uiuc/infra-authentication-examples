---
name: Register and Login
route: /register-and-login
---

# Register and Login

## Register Endpoint


| Endpoint | /register [POST] |
| ------ | ----------- |
| Body   | email, password, role,  index of security question in config file (optional), answer to security question (optional)  |
| Response 200 | userid, role, and token |
| Response 400 | error message |

(1) Checks that the request has the required fields (email, password, and role) 

(2) Ensures the user doesn't already have an account 

(3) Encrypts the password and creates the user's data

(4) If the security question is enabled, checks that the security question index is valid and that there is an answer

(5) Checks the permission level of the user using the config file

(6) If gmail is enabled, it sends an email with a generated PIN to verify the user

(7) Signs the jwt token, and the sends the signed token to the user along with the user's id and permission level


Example Request 

    { 
        url: "http://localhost:8000/register"
        headers: {
            "Content-Type":"application/json",
        }
        body: {
            "email":"whodatboy@h4i.org",
            "password":"me",
            "role":"guest",
            "questionIdx":0, // Don't include if security question is not enabled
            "answer":"Mambo No. 5" // Don't include if security question is not enabled
        }
    }





## Login Endpoint

### /POST yourserver.org/login

    body: {
        email: "whodatboy@h4i.org",
        password: "me"
    }

| Endpoint | /login [POST] |
| ------ | ----------- |
| Body   | email, password |
| Response 200 | userid, role, and token |
| Response 400 | error message |

1. The Authentictaion Server recieves an email and password.  It responds with a 400 error if any of the arguments aren't there. 
2. Finds the user in the database using the email. If the user doesn't exits or te user is using google oauth, it returns a corresponding error message. 
3. It encrypts the password and compares it to the password stored in the database. 
4. It sends a valid jwt token, user id, and permission level to the API. 
5. The API sends the token to the client. The client stores the token in cookies and sends it in the header of every request. 



